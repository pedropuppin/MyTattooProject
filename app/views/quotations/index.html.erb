<div class="container quotations-index">
  <%= link_to 'Back', user_profile_path(current_user) %>
  <h3 class="mb-4">Meus projetos</h3>
  <span class="mb-2 d-block"><small><em class="text-muted"><%= "Você não marcou nenhum projeto ainda!" if @quotations.empty? %></em></small></span>

  <div class="quotations-grid">
    <% @quotations.order(created_at: :desc).each do | quotation | %>
      <% artist = User.find(quotation.artist_id) %>
      <% user = User.find(quotation.user_id) %>
      <div class="quotation-cards">
        <div class="card-content">
          <div class="card-img">
            <% if user.photo.attached? %>
              <%= cl_image_tag user.photo.key, transformation: [{gravity: "face", height: 400, width: 400, crop: "thumb"}] %>
            <% else %>
              <%= image_tag "https://cdn-icons-png.flaticon.com/512/149/149071.png" %>
            <% end %>
          </div>
          <% if current_user.role == "client" %>
            <div class="card-product-infos">
              <h2>Nome do artista: <%= artist.first_name %></h2>
              <p><strong>Ideia da tattoo:</strong> <%= quotation.description %></p>
              <p><strong>Data:</strong> <%= quotation.date %></p>
              <div class="card-links">
                <%= link_to "informações", quotation_path(quotation), class: "mb-4" %>
              </div>
              <%= link_to quotation_path(quotation), class: "delete", data: { turbo_method: :delete, turbo_confirm: "Tem certeza que quer deletar o registro dessa sessão?" } do %>
                <i class="fa-solid fa-trash"></i>
              <% end %>
            </div>
          <% else %>
            <div class="card-product-infos">
              <h2>Nome do cliente: <%= user.first_name.capitalize %></h2>
              <p><strong>Ideia da tattoo:</strong> <%= quotation.description %></p>
              <p><strong>Data:</strong> <%= quotation.date %></p>
              <div class="card-links">
                <%= link_to "informações", quotation_path(quotation) %>
              </div>
              <%= link_to quotation_path(quotation), class: "delete", data: { turbo_method: :delete, turbo_confirm: "Tem certeza que quer deletar o registro dessa sessão?" } do %>
                <i class="fa-solid fa-trash"></i>
              <% end %>
          <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
